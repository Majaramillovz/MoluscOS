<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MOLUSCOS // BANCO_SEMILLAS</title>
    <style>
        /* --- TEMA VISUAL: AZUL COBALTO (TÉCNICO/PROFUNDO) --- */
        :root {
            --fondo: #000000;
            --tema: #0044FF; /* Azul Oscuro puro */
            --gris:  #333333;
            --rojo-aviso: #FF4444;
            --blanco: #ffffff;
        }
        
        /* BLOQUEO DE SELECCIÓN DE TEXTO (Vital para el arrastre) */
        * { 
            box-sizing: border-box; 
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none; 
            -webkit-user-drag: none;
        }
        
        html, body {
            min-height: 100%;
            background-color: var(--fondo);
            overscroll-behavior: none; 
            /* Cursor de mano para indicar que se puede agarrar */
            cursor: grab; 
        }

        body {
            margin: 0;
            padding: 5px;
            color: var(--tema);
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            overflow-x: hidden;
        }

        /* CLASE PARA CUANDO ESTÁS ARRASTRANDO */
        body.grabbing {
            cursor: grabbing;
        }

        .container {
            width: 100%;
            max-width: 720px;
            height: auto; 
            min-height: calc(100vh - 10px);
            border: 2px solid var(--tema);
            padding: 15px;
            background: rgba(0, 5, 20, 0.85);
            display: flex;
            flex-direction: column;
            position: relative;
            padding-bottom: 120px; 
            box-shadow: inset 0 0 25px rgba(0, 68, 255, 0.15);
        }

        /* BOTONES */
        .back-link, .download-btn {
            display: inline-block;
            color: #000;
            background: var(--tema);
            padding: 5px 12px;
            text-decoration: none;
            font-weight: 900;
            margin-bottom: 25px;
            text-transform: uppercase;
            font-size: 0.9rem;
            width: fit-content;
            box-shadow: 3px 3px 0px var(--gris);
            border: 1px solid var(--tema);
            cursor: pointer;
        }
        .back-link:active, .download-btn:active { transform: translate(2px, 2px); box-shadow: none; background: #fff; }

        .download-btn {
            margin-top: 10px;
            font-size: 0.8rem;
            background: #fff;
            color: var(--tema);
        }

        /* TIPOGRAFÍA */
        h1 { 
            border-bottom: 2px dashed var(--tema); 
            padding-bottom: 15px; 
            font-size: 1.4rem; 
            text-transform: uppercase; 
            margin-top: 10px; 
            text-shadow: 0 0 8px var(--tema);
            letter-spacing: 1px;
        }
        
        h2 { 
            background: var(--tema); 
            color: #000; 
            display: block; 
            padding: 5px 10px; 
            font-size: 1rem; 
            margin-top: 35px; 
            margin-bottom: 15px;
            font-weight: 900; 
            text-transform: uppercase;
            border-left: 5px solid #000;
        }

        h3 {
            color: var(--tema);
            border-bottom: 1px dotted var(--tema);
            padding-bottom: 5px;
            margin-top: 25px;
            font-size: 0.95rem;
            text-transform: uppercase;
        }
        
        p, li { 
            line-height: 1.6; 
            color: #ddd; 
            font-size: 0.95rem; 
            text-align: justify; 
            margin-bottom: 15px;
        }

        /* --- ESTILOS DE LA IMAGEN PEQUEÑA --- */
        .technical-image-container {
            margin: 25px 0;
            border: 2px solid var(--tema);
            padding: 5px;
            background: rgba(0,0,0,0.5);
            cursor: pointer; 
            transition: transform 0.2s;
        }
        .technical-image-container:hover {
            transform: scale(1.02);
            box-shadow: 0 0 15px var(--tema);
        }

        .technical-image {
            width: 100%;
            height: auto;
            display: block;
            pointer-events: none; /* Evita interferencia con el arrastre */
        }
        .img-caption {
            font-size: 0.8rem;
            color: var(--tema);
            text-align: center;
            padding: 5px;
            border-top: 1px dotted var(--tema);
            font-weight: bold;
        }
        .click-hint {
            font-size: 0.7rem;
            text-align: center;
            color: #fff;
            background: var(--tema);
            color: #000;
            font-weight: bold;
        }

        /* --- ESTILOS DEL VISUALIZADOR (MODAL CON ZOOM) --- */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.95); 
            overflow: hidden; 
        }

        .modal-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .modal-content {
            max-width: 95%;
            max-height: 90%;
            border: 2px solid var(--tema);
            box-shadow: 0 0 30px var(--tema);
            transform-origin: center center;
            transition: transform 0.1s ease-out;
            cursor: grab;
        }
        .modal-content:active { cursor: grabbing; }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: var(--tema);
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            z-index: 2001;
            background: rgba(0,0,0,0.5);
            padding: 0 10px;
            border-radius: 5px;
        }
        .close:hover { color: #fff; }

        /* Controles de Zoom Manual */
        .zoom-controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 2001;
        }
        .zoom-btn {
            background: rgba(0,0,0,0.8);
            color: var(--tema);
            border: 1px solid var(--tema);
            width: 40px; height: 40px;
            font-size: 20px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* OTROS ESTILOS */
        ul, ol { padding-left: 25px; }
        li::marker { color: var(--tema); font-weight: bold; content: ">> "; }
        strong.highlight { color: var(--tema); background: rgba(0, 68, 255, 0.2); padding: 0 3px;}

        .footer-section { margin-top: auto; padding-top: 40px; text-align: center; }
        .credits { font-size: 11px; color: #666; letter-spacing: 1px; padding-bottom: 10px; border-top: 1px solid var(--gris); padding-top: 15px; }

    </style>
</head>
<body>

<div id="myModal" class="modal">
  <span class="close" onclick="closeModal()">&times;</span>
  <div class="modal-wrapper">
      <img class="modal-content" id="img01">
  </div>
  <div class="zoom-controls">
      <button class="zoom-btn" onclick="manualZoom(-0.5)">-</button>
      <button class="zoom-btn" onclick="resetZoom()">R</button>
      <button class="zoom-btn" onclick="manualZoom(0.5)">+</button>
  </div>
</div>

<div class="container">
    <a href="index.html" class="back-link" onmousedown="playRadioClick()">< REGRESAR</a>
    
    <h1>MANUAL: BANCO DE SEMILLAS (MK-2 BIO)</h1>
    
    <section>
        <h2>00_PRINCIPIO_DE_OPERACIÓN</h2>
        <p>
            En la era de la escasez, la <strong class="highlight">soberanía alimentaria</strong> es la única arma real. Este dispositivo recupera la tecnología ancestral de las "Nendo Dango" (bolas de arcilla), utilizada por culturas antiguas para preservar la vida en tiempos de sequía.
        </p>
        <p>
            La carcasa de arcilla actúa como una bóveda del tiempo: protege el germen de las semillas de la radiación, las aves y los roedores. Al contacto con el agua, la "granada" se disuelve, liberando la vida contenida. Su diseño de arma es intencional: en un mundo hostil, sembrar es un acto de guerra contra el hambre.
        </p>
    </section>

    <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
        <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
        <img src="granada-esquema.png" alt="Esquema técnico de la granada" class="technical-image">
        <div class="img-caption">FIG.1: ANATOMÍA DEL BANCO DE SEMILLAS</div>
    </div>

    <section>
        <h2>01_MATRIZ 3D Y MOLDEO</h2>
        <p>
            Para el mecanismo de transporte (el gatillo/espoleta), necesitamos precisión mecánica. Usaremos impresión 3D para crear el molde maestro.
        </p>
        <ul>
            <li><strong>Descargar OBJ:</strong> Archivo "gatillo_mk2.obj".</li>
            <li><strong>Impresión:</strong> Usar PLA o PETG con altura de capa 0.2mm.</li>
            <li><strong>Molde:</strong> Sumergir la pieza impresa en una caja con Yeso de París. Al secar, tendremos un negativo perfecto para replicar la pieza en arcilla infinitas veces.</li>
        </ul>
        
        <a href="gatillo_mk2.obj" class="download-btn" download>[⬇ DESCARGAR ARCHIVO OBJ]</a>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="granada-fase1.png" alt="Proceso de impresión y molde" class="technical-image">
            <div class="img-caption">FIG.2: IMPRESIÓN 3D Y VACIADO EN YESO</div>
        </div>
    </section>

    <section>
        <h2>02_MODELADO DEL CUERPO (CARGA)</h2>
        <p>
            Esta es la fase crítica. Usaremos arcilla roja natural.
        </p>
        <ol>
            <li><strong>Forma Base:</strong> Modela un óvalo hueco (tipo huevo) con paredes de 1cm de grosor. Rellénalo con la mezcla de <em>Compost + Tierra</em>.</li>
            <li><strong>Blindaje (Sembrado):</strong> Inserta granos de maíz grandes en la superficie exterior. 
            <br><strong class="highlight">IMPORTANTE:</strong> El "germen" (la punta blanca del grano) debe ir hacia ADENTRO, enterrado en la arcilla. Si queda expuesto, el sol lo matará.</li>
        </ol>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="granada-fase2.png" alt="Modelado del cuerpo" class="technical-image">
            <div class="img-caption">FIG.3: INSERCIÓN GEOMÉTRICA DE MAÍZ</div>
        </div>
    </section>

    <section>
        <h2>03_FABRICACIÓN DEL SEGURO</h2>
        <p>
            El anillo y el pasador son puramente estéticos pero funcionales para el transporte (permiten colgar la granada).
        </p>
        <ul>
            <li>Modela un "churro" o cilindro fino de arcilla.</li>
            <li>Dale forma circular (3cm de diámetro) y deja secar al sol hasta que endurezca (estado de cuero).</li>
        </ul>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="granada-fase3.png" alt="Modelado del aro" class="technical-image">
            <div class="img-caption">FIG.4: DETALLE DEL ANILLO DE ARCILLA</div>
        </div>
    </section>

    <section>
        <h2>04_ENSAMBLAJE FINAL</h2>
        <p>
            Une todas las piezas antes de que la arcilla se seque por completo.
        </p>
        <ol>
            <li>Prepara <strong>Barbotina</strong> (mezcla de arcilla y agua con consistencia de yogur) para usar como pegamento.</li>
            <li>Aplica barbotina en la base del gatillo (que sacaste del molde de yeso de la Fase 1) y únelo al cuerpo de la granada.</li>
            <li>Inserta el anillo en el orificio del gatillo.</li>
            <li>Deja secar a la sombra durante 48 horas para evitar grietas.</li>
        </ol>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="granada-fase4.png" alt="Ensamblaje con barbotina" class="technical-image">
            <div class="img-caption">FIG.5: UNIÓN CON BARBOTINA</div>
        </div>
    </section>

    <div class="footer-section">
        <div class="credits">
            [MoluscOS] -- [GPLv3]
        </div>
    </div>
</div>

<script>
    // --- 1. SCRIPT DE ARRASTRE (DRAG TO SCROLL) ---
    const body = document.body;
    let isDown = false;
    let startY;
    let scrollTop;

    window.addEventListener('mousedown', (e) => {
        // Evitar que el scroll funcione si el modal está abierto
        if (document.getElementById("myModal").style.display === "block") return;
        
        isDown = true;
        body.classList.add('grabbing');
        startY = e.pageY - document.documentElement.scrollTop;
        scrollTop = document.documentElement.scrollTop;
    });

    window.addEventListener('mouseleave', () => { isDown = false; body.classList.remove('grabbing'); });
    window.addEventListener('mouseup', () => { isDown = false; body.classList.remove('grabbing'); });

    window.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const y = e.pageY - document.documentElement.scrollTop;
        const walk = (y - startY) * 1.5;
        window.scrollTo({ top: scrollTop - walk });
    });

    // --- 2. LÓGICA DEL MODAL Y ZOOM ---
    var modal = document.getElementById("myModal");
    var modalImg = document.getElementById("img01");
    let currentScale = 1;
    let currentX = 0, currentY = 0, startXZoom = 0, startYZoom = 0;
    let isDraggingZoom = false;

    function openModal(element){
        var img = element.querySelector('img'); 
        modal.style.display = "block";
        modalImg.src = img.src;
        resetZoom();
    }
    function closeModal() { modal.style.display = "none"; }
    function resetZoom() { currentScale = 1; currentX = 0; currentY = 0; updateTransform(); }
    function updateTransform() {
        if (currentScale < 1) currentScale = 1; 
        modalImg.style.transform = `translate(${currentX}px, ${currentY}px) scale(${currentScale})`;
    }
    function manualZoom(delta) { currentScale += delta; updateTransform(); }

    // Eventos Zoom Mouse
    modalImg.addEventListener('mousedown', (e) => {
        if (currentScale > 1) { isDraggingZoom = true; startXZoom = e.clientX - currentX; startYZoom = e.clientY - currentY; }
    });
    window.addEventListener('mousemove', (e) => {
        if (isDraggingZoom) { e.preventDefault(); currentX = e.clientX - startXZoom; currentY = e.clientY - startYZoom; updateTransform(); }
    });
    window.addEventListener('mouseup', () => { isDraggingZoom = false; });

    // Eventos Zoom Táctil
    let initialPinchDistance = 0;
    modalImg.addEventListener('touchstart', (e) => {
        if (e.touches.length === 1 && currentScale > 1) {
            isDraggingZoom = true;
            startXZoom = e.touches[0].clientX - currentX;
            startYZoom = e.touches[0].clientY - currentY;
        } else if (e.touches.length === 2) {
            isDraggingZoom = false;
            initialPinchDistance = Math.hypot(
                e.touches[0].clientX - e.touches[1].clientX,
                e.touches[0].clientY - e.touches[1].clientY
            );
        }
    });

    modalImg.addEventListener('touchmove', (e) => {
        if (e.touches.length === 1 && isDraggingZoom) {
            e.preventDefault();
            currentX = e.touches[0].clientX - startXZoom;
            currentY = e.touches[0].clientY - startYZoom;
            updateTransform();
        } else if (e.touches.length === 2) {
            e.preventDefault();
            const currentDistance = Math.hypot(
                e.touches[0].clientX - e.touches[1].clientX,
                e.touches[0].clientY - e.touches[1].clientY
            );
            const scaleChange = currentDistance / initialPinchDistance;
            if (scaleChange > 1) currentScale += 0.05; 
            else if (scaleChange < 1) currentScale -= 0.05;
            initialPinchDistance = currentDistance;
            updateTransform();
        }
    });
    modalImg.addEventListener('touchend', () => { isDraggingZoom = false; });

    // --- SONIDO ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playRadioClick() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const noise = audioCtx.createBufferSource();
        const gain = audioCtx.createGain();
        const filter = audioCtx.createBiquadFilter();
        const bufferSize = audioCtx.sampleRate * 0.1; 
        const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) { data[i] = Math.random() * 2 - 1; }
        noise.buffer = buffer;
        filter.type = 'bandpass'; filter.frequency.value = 1200; filter.Q.value = 1.5;
        osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.15);
        noise.connect(filter); filter.connect(gain); osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); noise.start(); osc.stop(audioCtx.currentTime + 0.15); noise.stop(audioCtx.currentTime + 0.15);
    }
</script>

</body>
</html>
