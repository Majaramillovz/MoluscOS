<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MOLUSCOS // RADIO_DIY_V2</title>
    <style>
        /* --- TEMA VISUAL: AZUL COBALTO (TÉCNICO/PROFUNDO) --- */
        :root {
            --fondo: #000000;
            --tema: #0044FF; /* Azul Oscuro puro */
            --gris:  #333333;
            --rojo-aviso: #FF4444;
            --blanco: #ffffff;
        }
        
        /* --- CORRECCIÓN MAGISTRAL: BLOQUEO DE SELECCIÓN DE TEXTO --- */
        * { 
            box-sizing: border-box; 
            /* Esto evita que se ponga azul el texto al arrastrar el dedo */
            -webkit-user-select: none; /* Safari / Chrome */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Estándar */
            -webkit-touch-callout: none; /* Evita menú contextual en iOS */
        }
        
        html {
            min-height: 100%;
            background-color: var(--fondo);
            /* Evita el efecto elástico de rebote en móviles */
            overscroll-behavior: none;
        }

        body {
            width: 100%;
            min-height: 100vh;
            margin: 0;
            padding: 5px;
            background-color: var(--fondo);
            color: var(--tema);
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            overflow-x: hidden;
            /* Mejora la respuesta táctil */
            touch-action: pan-y; 
        }

        .container {
            width: 100%;
            max-width: 720px;
            height: auto; 
            min-height: calc(100vh - 10px);
            border: 2px solid var(--tema);
            padding: 15px;
            background: rgba(0, 5, 20, 0.85);
            display: flex;
            flex-direction: column;
            position: relative;
            padding-bottom: 120px; 
            box-shadow: inset 0 0 25px rgba(0, 68, 255, 0.15);
        }

        /* BOTONES */
        .back-link {
            display: inline-block;
            color: #000;
            background: var(--tema);
            padding: 5px 12px;
            text-decoration: none;
            font-weight: 900;
            margin-bottom: 25px;
            text-transform: uppercase;
            font-size: 0.9rem;
            width: fit-content;
            box-shadow: 3px 3px 0px var(--gris);
            border: 1px solid var(--tema);
        }
        .back-link:active { transform: translate(2px, 2px); box-shadow: none; background: #fff; }

        /* TIPOGRAFÍA */
        h1 { 
            border-bottom: 2px dashed var(--tema); 
            padding-bottom: 15px; 
            font-size: 1.4rem; 
            text-transform: uppercase; 
            margin-top: 10px; 
            text-shadow: 0 0 8px var(--tema);
            letter-spacing: 1px;
        }
        
        h2 { 
            background: var(--tema); 
            color: #000; 
            display: block; 
            padding: 5px 10px; 
            font-size: 1rem; 
            margin-top: 35px; 
            margin-bottom: 15px;
            font-weight: 900; 
            text-transform: uppercase;
            border-left: 5px solid #000;
        }

        h3 {
            color: var(--tema);
            border-bottom: 1px dotted var(--tema);
            padding-bottom: 5px;
            margin-top: 25px;
            font-size: 0.95rem;
            text-transform: uppercase;
        }
        
        p, li { 
            line-height: 1.6; 
            color: #ddd; 
            font-size: 0.95rem; 
            text-align: justify; 
            margin-bottom: 15px;
        }

        /* --- ESTILOS DE LA IMAGEN PEQUEÑA --- */
        .technical-image-container {
            margin: 25px 0;
            border: 2px solid var(--tema);
            padding: 5px;
            background: rgba(0,0,0,0.5);
            cursor: pointer; 
            transition: transform 0.2s;
        }
        .technical-image-container:hover {
            transform: scale(1.02);
            box-shadow: 0 0 15px var(--tema);
        }

        .technical-image {
            width: 100%;
            height: auto;
            display: block;
            pointer-events: none; /* Evita que la imagen pequeña capture eventos raros */
        }
        .img-caption {
            font-size: 0.8rem;
            color: var(--tema);
            text-align: center;
            padding: 5px;
            border-top: 1px dotted var(--tema);
            font-weight: bold;
        }
        .click-hint {
            font-size: 0.7rem;
            text-align: center;
            color: #fff;
            background: var(--tema);
            color: #000;
            font-weight: bold;
        }

        /* --- ESTILOS DEL VISUALIZADOR (MODAL CON ZOOM) --- */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.95); 
            overflow: hidden; /* Importante para el zoom */
            touch-action: none; /* EVITA QUE EL NAVEGADOR INTERFIERA EN EL ZOOM */
        }

        /* Wrapper para centrar */
        .modal-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .modal-content {
            max-width: 95%;
            max-height: 90%;
            border: 2px solid var(--tema);
            box-shadow: 0 0 30px var(--tema);
            transform-origin: center center;
            transition: transform 0.1s ease-out;
            cursor: grab;
            /* Asegura que la imagen no se ponga azul al tocarla mucho */
            -webkit-user-drag: none; 
        }
        .modal-content:active { cursor: grabbing; }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: var(--tema);
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            z-index: 2001;
            background: rgba(0,0,0,0.5);
            padding: 0 10px;
            border-radius: 5px;
        }
        .close:hover { color: #fff; }

        /* Controles Manuales de Zoom */
        .zoom-controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 2001;
        }
        .zoom-btn {
            background: rgba(0,0,0,0.8);
            color: var(--tema);
            border: 1px solid var(--tema);
            width: 40px; height: 40px;
            font-size: 20px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* OTROS ESTILOS */
        ul, ol { padding-left: 25px; }
        li::marker { color: var(--tema); font-weight: bold; content: ">> "; }
        strong.highlight { color: var(--tema); background: rgba(0, 68, 255, 0.2); padding: 0 3px;}

        .warning-box {
            border: 2px dashed var(--rojo-aviso);
            background: rgba(50, 0, 0, 0.3);
            padding: 15px;
            margin: 20px 0;
            color: var(--rojo-aviso);
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .warning-icon { font-size: 1.5rem; }

        .footer-section { margin-top: auto; padding-top: 40px; text-align: center; }
        .credits { font-size: 11px; color: #666; letter-spacing: 1px; padding-bottom: 10px; border-top: 1px solid var(--gris); padding-top: 15px; }

        .nav-pad {
            position: fixed; bottom: 25px; right: 25px; z-index: 1000;
            display: flex; flex-direction: column; gap: 15px;
        }
        .nav-btn {
            background: rgba(0,0,0,0.9); color: var(--tema); border: 2px solid var(--tema);
            width: 50px; height: 50px; font-size: 20px; cursor: crosshair;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 15px var(--tema); opacity: 0.8;
            transition: all 0.1s;
        }
        .nav-btn:active { background: var(--tema); color: #000; transform: scale(0.95); box-shadow: 0 0 5px var(--tema); }

    </style>
</head>
<body>

<div class="nav-pad">
    <button class="nav-btn" onmousedown="playRadioClick()" onclick="scrollUp()">▲</button>
    <button class="nav-btn" onmousedown="playRadioClick()" onclick="scrollDown()">▼</button>
</div>

<div id="myModal" class="modal">
  <span class="close" onclick="closeModal()">&times;</span>
  
  <div class="modal-wrapper">
      <img class="modal-content" id="img01">
  </div>
  
  <div class="zoom-controls">
      <button class="zoom-btn" onclick="manualZoom(-0.5)">-</button>
      <button class="zoom-btn" onclick="resetZoom()">R</button>
      <button class="zoom-btn" onclick="manualZoom(0.5)">+</button>
  </div>
</div>

<div class="container">
    <a href="index.html" class="back-link" onmousedown="playRadioClick()">< REGRESAR</a>
    
    <h1>MANUAL: ANTENA DIPOLO AJUSTABLE (CINTA MÉTRICA)</h1>
    
    <section>
        <h2>00_PRINCIPIO_DE_OPERACIÓN</h2>
        <p>
            En ausencia de infraestructura global, la comunicación local (VHF/UHF) es vital. Este diseño utiliza <strong class="highlight">cintas métricas metálicas</strong> como elementos radiantes. Su ventaja es doble: son flexibles (resisten el viento) y, crucialmente, son <strong class="highlight">ajustables en longitud</strong>, lo que permite sintonizar la antena para diferentes frecuencias (ej. banda marina, radioaficionado 2m, o radio FM de emergencia) simplemente extendiendo o retrayendo la cinta.
        </p>
    </section>

    <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
        <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
        <img src="antena-radio.jpg" alt="Esquema técnico" class="technical-image">
        <div class="img-caption">FIG.1: ESQUEMA DEL DISPOSITIVO</div>
    </div>

    <section>
        <h2>01_LISTA_DE_MATERIALES (BOM)</h2>
        <ul>
            <li><strong>2x Cintas Métricas Metálicas:</strong> De bajo costo. El ancho de la cinta mejora el ancho de banda (la recepción). Se cortarán según la necesidad.</li>
            <li><strong>Bloque Central Aislante:</strong> Madera tratada, PVC o impresión 3D (PETG). Debe separar eléctricamente los dos brazos de la antena.</li>
            <li><strong>Cable Coaxial (RG-58):</strong> La línea de transmisión hacia tu radio. 50 Ohmios de impedancia estándar.</li>
            <li><strong>Ferrita Toroidal (Balun 1:1):</strong> Recuperada de fuentes de poder viejas o cables de monitor. Vital para evitar que el cable coaxial irradie interferencia.</li>
            <li><strong>Caja de Empalme Impermeable:</strong> Una caja de derivación eléctrica pequeña para proteger la conexión central.</li>
            <li><strong>Sistema de Izado:</strong> Cuerda de driza resistente a UV y una polea simple para elevar la antena sobre el follaje.</li>
        </ul>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="radio-materiales-diy.jpg" alt="Lista de materiales" class="technical-image">
            <div class="img-caption">FIG.2: DETALLE DE MATERIALES</div>
        </div>
    </section>

    <section>
        <h2>02_PROTOCOLO_DE_CONSTRUCCIÓN</h2>
        
        <h3>FASE A: PREPARACIÓN DEL NÚCLEO</h3>
        <ol>
            <li>Lija los extremos de las cintas métricas donde harás la conexión eléctrica para eliminar la pintura y asegurar un buen contacto.</li>
            <li>Fija las cintas al <strong>Bloque Central</strong>. Deben quedar alineadas horizontalmente pero <strong>separadas entre sí</strong> por al menos 2-3 cm en el centro. No deben tocarse.</li>
        </ol>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="radio-fasea.jpg" alt="Preparación del núcleo" class="technical-image">
            <div class="img-caption">FIG.3: MONTAJE DEL NÚCLEO</div>
        </div>

        <h3>FASE B: EL BALUN (Choque de RF)</h3>
        <p>Como muestra el detalle en la <em>Fig.1</em>, el cable coaxial es asimétrico y la antena dipolo es simétrica. Sin un balun, el exterior del cable actuará como parte de la antena, arruinando el patrón de radiación y captando ruido.</p>
        <ol>
            <li>Toma el cable coaxial RG-58 cerca del extremo que va a la antena.</li>
            <li>Enrolla de 6 a 8 vueltas apretadas del cable coaxial a través de la <strong>Ferrita Toroidal</strong>. Esto crea un choque de RF (Balun 1:1 de corriente) que fuerza la señal a ir solo a la antena.</li>
        </ol>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="radio-faseb.jpg" alt="Construcción del Balun" class="technical-image">
            <div class="img-caption">FIG.4: BOBINADO DEL BALUN</div>
        </div>

        <h3>FASE C: CONEXIÓN Y SELLADO</h3>
        <ol>
            <li>Dentro de la <strong>Caja Impermeable</strong>, pela el extremo del coaxial que sale del balun.</li>
            <li>Separa el vivo (núcleo central) de la malla (blindaje).</li>
            <li>Conecta el <strong>vivo central</strong> a una de las cintas métricas (usa tornillos y terminales de anillo soldados para mayor robustez).</li>
            <li>Conecta la <strong>malla trenzada</strong> a la OTRA cinta métrica.</li>
            <li>Sella la caja herméticamente con silicona o prensaestopas. La humedad destruirá el coaxial.</li>
        </ol>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="radio-fasec.jpg" alt="Conexión final" class="technical-image">
            <div class="img-caption">FIG.5: CONEXIÓN Y SELLADO</div>
        </div>
    </section>

    <section>
        <h2>03_DESPLIEGUE Y SINTONÍA</h2>
        <div class="warning-box">
            <span class="warning-icon">[!]</span>
            <span>ADVERTENCIA: PELIGRO DE MUERTE. Nunca despliegues antenas cerca de líneas eléctricas. Mantén una distancia de caída de 2x la altura del mástil o árbol.</span>
        </div>
        <p>
            Usa el sistema de driza y polea para elevar la antena lo más alto posible en una rama despejada. La altura es señal.
        </p>
        <p>
            <strong>Sintonía:</strong> Para la banda de 2 metros (aprox. 145 MHz), extiende cada lado de la cinta métrica a aproximadamente 49 cm desde el centro. Usa un medidor de ROE (SWR) si tienes uno. Si la ROE es alta en frecuencias bajas, acorta la cinta. Si es alta en frecuencias altas, alarga la cinta.
        </p>

        <div class="technical-image-container" onclick="openModal(this); playRadioClick();">
            <div class="click-hint">[ CLIC PARA AMPLIAR ]</div>
            <img src="radio-sintonia.jpg" alt="Antena izada" class="technical-image">
            <div class="img-caption">FIG.6: SISTEMA OPERATIVO</div>
        </div>
    </section>

    <div class="footer-section">
        <div class="credits">
            [MoluscOS] -- [GPLv3]
        </div>
    </div>
</div>

<script>
    // --- MOTOR DE ZOOM MEJORADO ---
    var modal = document.getElementById("myModal");
    var modalImg = document.getElementById("img01");
    
    // Variables
    let currentScale = 1;
    let currentX = 0;
    let currentY = 0;
    let startX = 0;
    let startY = 0;
    let isDragging = false;
    let initialPinchDistance = 0;

    // Abrir Modal
    function openModal(element){
        var img = element.querySelector('img'); 
        modal.style.display = "block";
        modalImg.src = img.src;
        resetZoom();
    }

    function closeModal() {
        modal.style.display = "none";
    }

    function resetZoom() {
        currentScale = 1;
        currentX = 0;
        currentY = 0;
        updateTransform();
    }

    function updateTransform() {
        if (currentScale < 1) currentScale = 1; 
        modalImg.style.transform = `translate(${currentX}px, ${currentY}px) scale(${currentScale})`;
    }

    function manualZoom(delta) {
        currentScale += delta;
        updateTransform();
    }

    // --- EVENTOS DE RATÓN (PC) ---
    modalImg.addEventListener('mousedown', (e) => {
        if (currentScale > 1) {
            isDragging = true;
            startX = e.clientX - currentX;
            startY = e.clientY - currentY;
            modalImg.style.cursor = 'grabbing';
        }
    });

    window.addEventListener('mouseup', () => {
        isDragging = false;
        modalImg.style.cursor = 'grab';
    });

    window.addEventListener('mousemove', (e) => {
        if (isDragging) {
            e.preventDefault();
            currentX = e.clientX - startX;
            currentY = e.clientY - startY;
            updateTransform();
        }
    });

    modal.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = e.deltaY * -0.002;
        currentScale += delta;
        updateTransform();
    });

    // --- EVENTOS TÁCTILES (MÓVIL) ---
    modalImg.addEventListener('touchstart', (e) => {
        if (e.touches.length === 1 && currentScale > 1) {
            isDragging = true;
            startX = e.touches[0].clientX - currentX;
            startY = e.touches[0].clientY - currentY;
        } else if (e.touches.length === 2) {
            isDragging = false;
            initialPinchDistance = getDistance(e.touches);
        }
    });

    modalImg.addEventListener('touchmove', (e) => {
        // e.preventDefault(); // Comentado para permitir comportamiento nativo si no hay drag
        if (e.touches.length === 1 && isDragging) {
            e.preventDefault(); // Solo prevenimos scroll si estamos arrastrando la imagen
            currentX = e.touches[0].clientX - startX;
            currentY = e.touches[0].clientY - startY;
            updateTransform();
        } else if (e.touches.length === 2) {
            e.preventDefault();
            const currentDistance = getDistance(e.touches);
            const scaleChange = currentDistance / initialPinchDistance;
            if (scaleChange > 1) currentScale += 0.05; 
            else if (scaleChange < 1) currentScale -= 0.05;
            initialPinchDistance = currentDistance;
            updateTransform();
        }
    });

    modalImg.addEventListener('touchend', () => {
        isDragging = false;
    });

    function getDistance(touches) {
        return Math.hypot(
            touches[0].clientX - touches[1].clientX,
            touches[0].clientY - touches[1].clientY
        );
    }

    // --- SONIDO ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playRadioClick() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const noise = audioCtx.createBufferSource();
        const gain = audioCtx.createGain();
        const filter = audioCtx.createBiquadFilter();
        const bufferSize = audioCtx.sampleRate * 0.1; 
        const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) { data[i] = Math.random() * 2 - 1; }
        noise.buffer = buffer;
        filter.type = 'bandpass'; filter.frequency.value = 1200; filter.Q.value = 1.5;
        osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.15);
        noise.connect(filter); filter.connect(gain); osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); noise.start(); osc.stop(audioCtx.currentTime + 0.15); noise.stop(audioCtx.currentTime + 0.15);
    }
    
    function scrollDown() { window.scrollBy({ top: 350, behavior: 'smooth' }); }
    function scrollUp() { window.scrollBy({ top: -350, behavior: 'smooth' }); }
</script>

</body>
</html>
